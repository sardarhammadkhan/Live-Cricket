(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{4169:function(e,r,n){"use strict";n.r(r);var t=n(44),a=n(152),c=n(19);function o(e,r,n,t,a,c,o){try{var u=e[c](o),i=u.value}catch(e){return void n(e)}u.done?r(i):Promise.resolve(i).then(t,a)}function u(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var c=e.apply(r,n);function u(e){o(c,t,a,u,i,"next",e)}function i(e){o(c,t,a,u,i,"throw",e)}u(void 0)}))}}var i=Object(c.default)("ion:cupboard:migration"),s=[],f=function(){var e=u(regeneratorRuntime.mark((function e(r,n,t){var a,c,o,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=function(){var e=a(r),t=a(n);if(-1===t)throw new Error("No migration object found for target version ".concat(n));if(e>t)throw new Error("Downgrade operation is not supported. ".concat(r," ").concat(n));if(e!==t)return o(c(e,t));i.warn("Migration path called for same current and target versions ".concat(r," ").concat(n))},f=function(){return(f=u(regeneratorRuntime.mark((function e(a){var c,o,u,s,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i.info("Starting cupboard upgrade from ".concat(r," to ").concat(n)),c=!0,o=!1,u=void 0,e.prev=4,s=a[Symbol.iterator]();case 6:if(c=(f=s.next()).done){e.next=13;break}return p=f.value,e.next=10,p.upgradeFn(t);case 10:c=!0,e.next=6;break;case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(4),o=!0,u=e.t0;case 19:e.prev=19,e.prev=20,c||null==s.return||s.return();case 22:if(e.prev=22,!o){e.next=25;break}throw u;case 25:return e.finish(22);case 26:return e.finish(19);case 27:i.info("Finished cupboard upgrade from ".concat(r," to ").concat(n));case 28:case"end":return e.stop()}}),e,null,[[4,15,19,27],[20,,22,26]])})))).apply(this,arguments)},o=function(e){return f.apply(this,arguments)},c=function(e,r){return s.slice(e+1,r+1)},a=function(e){return s.findIndex((function(r){return r.key===e}))},e.abrupt("return",p());case 6:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}(),p={key:"v6.0.0",upgradeFn:function(e){if(null==e||""===e)return Promise.resolve();return a.a.call("cupboard.clearNamespace",{namespace:e})}};s.push(p);var v=f;function m(e,r,n,t,a,c,o){try{var u=e[c](o),i=u.value}catch(e){return void n(e)}u.done?r(i):Promise.resolve(i).then(t,a)}function l(e){return function(){var r=this,n=arguments;return new Promise((function(t,a){var c=e.apply(r,n);function o(e){m(c,t,a,o,u,"next",e)}function u(e){m(c,t,a,o,u,"throw",e)}o(void 0)}))}}var d=Object(c.default)("ion:cupboard"),g=Object(t.b)().objectPersistence,h=function(e,r){return null==e?r:"".concat(e,"_").concat(r)},b={clear:function(){return new Promise((function(e){g.clear().then((function(){return e()})).catch(d.error)}))},clearNamespace:function(e){return l(regeneratorRuntime.mark((function r(){var n,t;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,g.keys();case 2:return n=r.sent,t=n.filter((function(r){return r.startsWith(e)})),r.next=6,Promise.all(t.map((function(e){return g.removeItem(e)})));case 6:case"end":return r.stop()}}),r)})))()},get:function(e,r){return new Promise((function(n){var t=h(e,r);g.getItem(t).then((function(e){return n(e)})).catch((function(e){return d.error(e)}))}))},set:function(e,r,n){var t=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return l(regeneratorRuntime.mark((function c(){var o;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,t.get(e,"SCHEMA_VERSION");case 2:if(o=c.sent,a||"v6.0.0"===o){c.next=5;break}return c.abrupt("return");case 5:return c.next=7,g.setItem(h(e,r),n);case 7:case"end":return c.stop()}}),c)})))()},migrate:function(e){var r=this;return l(regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.get(e,"SCHEMA_VERSION");case 2:if(t=n.sent,n.prev=3,"v6.0.0"===t){n.next=7;break}return n.next=7,v(t,"v6.0.0",e);case 7:n.next=14;break;case 9:return n.prev=9,n.t0=n.catch(3),d.error("Failed to migrate to version ".concat("v6.0.0"," from ").concat(t," error ").concat(JSON.stringify(n.t0),". Clearing cupboard.")),n.next=14,r.clear();case 14:return n.prev=14,n.next=17,r.set(e,"SCHEMA_VERSION","v6.0.0",!0);case 17:return n.finish(14);case 18:case"end":return n.stop()}}),n,null,[[3,9,14,18]])})))()}};a.a.register("cupboard.get",(function(e){var r=e.namespace,n=e.key;return b.get(r,n)})),a.a.register("cupboard.set",(function(e){var r=e.namespace,n=e.key,t=e.value,a=e.forceWrite;return b.set(r,n,t,a)})),a.a.register("cupboard.clear",(function(){return b.clear()})),a.a.register("cupboard.clearNamespace",(function(e){var r=e.namespace;return b.clearNamespace(r)})),a.a.register("cupboard.migrate",(function(e){var r=e.namespace;return b.migrate(r)}));r.default=b}}]);